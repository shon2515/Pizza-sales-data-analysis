-- ===========================================
-- Project: Pizza Sales Analysis
-- Tools: SQL + Excel 
-- Description: Analyze pizza sales data to understand revenue, order behavior, 
-- sales by category and size, and top-selling pizzas.
-- ===========================================

-- 1Ô∏è‚É£ Total Revenue
SELECT 
    SUM(total_price) AS total_revenue
FROM pizza_sales;


-- 2Ô∏è‚É£ Average Order Value (AOV)
SELECT 
    CAST(SUM(total_price) * 1.0 / COUNT(DISTINCT order_id) AS DECIMAL(10,2)) AS avg_order_value
FROM pizza_sales;


-- 3Ô∏è‚É£ Total Pizzas Sold
SELECT 
    SUM(quantity) AS total_pizzas_sold
FROM pizza_sales;


-- 4Ô∏è‚É£ Total Orders
SELECT 
    COUNT(DISTINCT order_id) AS total_orders
FROM pizza_sales;


-- 5Ô∏è‚É£ Average Pizzas per Order
SELECT 
    CAST(SUM(quantity) * 1.0 / COUNT(DISTINCT order_id) AS DECIMAL(10,2)) AS avg_pizzas_per_order
FROM pizza_sales;


-- 6Ô∏è‚É£ Daily Trend for Total Orders
SELECT 
    DATENAME(WEEKDAY, order_date) AS order_day,
    COUNT(DISTINCT order_id) AS total_orders
FROM pizza_sales
GROUP BY DATENAME(WEEKDAY, order_date)
ORDER BY DATEPART(WEEKDAY, order_date);  -- To keep the days in order


-- 7Ô∏è‚É£ Hourly Trend for Total Orders
SELECT 
    DATEPART(HOUR, order_time) AS order_hour,
    COUNT(DISTINCT order_id) AS total_orders
FROM pizza_sales
GROUP BY DATEPART(HOUR, order_time)
ORDER BY order_hour;


-- 8Ô∏è‚É£ Total Sales and Percentage Share by Pizza Category
SELECT 
    pizza_category,
    ROUND(SUM(total_price), 2) AS total_sales,
    ROUND(SUM(total_price) * 100.0 / (SELECT SUM(total_price) FROM pizza_sales), 2) AS sales_percentage
FROM pizza_sales
GROUP BY pizza_category
ORDER BY sales_percentage ASC;


-- 9Ô∏è‚É£ Percentage of Sales by Pizza Size
SELECT 
    pizza_size,
    ROUND(SUM(total_price), 2) AS total_sales,
    ROUND(SUM(total_price) * 100.0 / (SELECT SUM(total_price) FROM pizza_sales), 2) AS sales_percentage
FROM pizza_sales
GROUP BY pizza_size
ORDER BY sales_percentage DESC;


-- üîü Total Pizzas Sold by Pizza Category
SELECT 
    pizza_category,
    SUM(quantity) AS total_pizzas_sold
FROM pizza_sales
GROUP BY pizza_category
ORDER BY total_pizzas_sold DESC;


-- 1Ô∏è‚É£1Ô∏è‚É£ Top 5 Best-Selling Pizzas
SELECT TOP 5
    pizza_name,
    SUM(quantity) AS total_pizzas_sold
FROM pizza_sales
GROUP BY pizza_name
ORDER BY total_pizzas_sold DESC;


-- 1Ô∏è‚É£2Ô∏è‚É£ Top 5 Worst-Selling Pizzas
SELECT TOP 5
    pizza_name,
    SUM(quantity) AS total_pizzas_sold
FROM pizza_sales
GROUP BY pizza_name
ORDER BY total_pizzas_sold ASC;
